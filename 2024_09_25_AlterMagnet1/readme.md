
# 概要

中先生の交代磁性の論文Spin current generation in organic antiferromagnets
[リンク](https://www.nature.com/articles/s41467-019-12229-y)
と「交替磁性体のスピン分裂と交差相」(固体物理2024-05)の中に出てくる
κ-(ET)2-X についての計算についてのフォルダである。

# 構造

ノート兼実行環境用の jupyter notebook とスクリプト用の `/lib/funcs.py` の2つが本体である。
`/lib/funcs.py` の中には計算で使う関数や定数と、
相互作用の大きさと電子密度、メッシュのサイズを変えた κ-(ET)2-X を
1つのオブジェクトとするための class になっている。

クラスの中には
計算をするためのメソッド

- `calc_scf()`: 自己無撞着計算をする
- `calc_nscf()`: scf 計算で得られたフェルミエネルギーと反強磁性磁化の大きさをもとに
エネルギー分散とその固有状態を求める
- `calc_dos()`: 状態密度を求める
- `calc_kF_index()`: ブリュアンゾーンをメッシュに切ったときのフェルミ波数のインデックスを求める **(工事中)**
- `calc_spin_conductivity(mu, nu)`: スピン伝導度を求める **(工事中)**
- `calc_conductivity(mu, nu)`: 電気伝導度を求める **(工事中)**

と表示をするためのメソッド

- `plot_nsite()`: scf 計算の各ステップにおける各サイトを占有する電子の数
- `plot_scf()`: scf 計算の各ステップにおけるフェルミエネルギーと反強磁性磁化の大きさ
- `plot_band()`: ブリュアンゾーンのパスに沿ったエネルギー分散
- `plot_dos()`: 状態密度
- `plot_fermi_surface()`: フェルミ面の表示 **(工事中)**
- `plot3d_band()`: バンド分散を3次元で表示

が用意されている。

docstring を簡単には書いてあるので詳細は `funcs.py` を解読するとわかるはず
(わかりくかったらごめんなさい)。

`資料/`は元論文や関連資料が入っている。

`output/`は計算に時間がかかるものの出力結果を入れている。
ただ、計算が合っていないものも入っていたりするので気を付けてほしい。

各物理量を計算するのに

``` python
model = fs.KappaET2X(U, Ne, k_mesh)     # インスタンスの作成
model.calc_scf()        # フェルミエネルギーと反強磁性秩序変数の大きさ
model.calc_nscf()       # エネルギー分散とその固有値を求める
```

というようにしてから dos 等を計算するとよい。

# 問題点

伝導度の計算をするとグラフの形は合うが、値が約20倍ずれている。
心当たりがないので困った。

# 工事中について

伝導度の計算にフェルミ面上の値を気にしなければならないところがあって、
そのためにフェルミ波数が必要だと考えている。
しかし、ブリュアンゾーンをメッシュで区切るのは効率的でないようである。
なのでこれの本質的な解決策として

- フェルミ波数を正確に選びだしてフェルミ面上の積分を正確に行う
- フェルミ面上かどうかを気にせずに済むように久保公式を数値計算する

のいずれかである。

ただ、現在はメッシュを細かくしてやることで、
結果的にフェルミ面上の点を正確にとることができるというやり方でやっている。
この方法は収束が悪く、よい方法ではない。

# その他

`lib/` の中には `__init__.py` と `post.py` が入っている。

`__init__.py` はモジュールとしてこのフォルダを読み取るためのもので、
まぁよくあるやつである。

`post.py` は Discord や Slack に webhook を通じて通知をするものである。
これを使うことで長い計算の進捗をスマホで見ることができるようになる。
