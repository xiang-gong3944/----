
# 概要

交代磁性についての Smejkal-Sinova の Phys.Rev.X 12040501 にある Ru2 の模式図を見ると、
銅酸化物の2次元正方格子を歪ませたように見える。
なので Toy model として銅酸化物をひずませた模型を作って、
交代磁性が出るかを確認してみるというアイデアが出てもおかしくはない。
しかし、遠山先生曰くなぜかやった結果というのが出回っていないらしい。

なのでこのモデルを調べて、相図やスピン伝導度、超伝導との関連も見たいといった目標である。

# 構造

ノート兼実行環境用の jupyter notebook とスクリプト用の `funcs.py` の2つが本体である。
`funcs.py` の中には計算で使う関数や定数と、
相互作用の大きさと電子密度、メッシュのサイズを変えた CuO2 を
1つのオブジェクトとするための class になっている。

クラスの中には
計算をするためのメソッド

- `calc_scf()`: 自己無撞着計算をしてフェルミエネルギーと反強磁性秩序変数を決める
- `calc_nscf()`: scf 計算で得られたフェルミエネルギーと反強磁性磁化の大きさをもとに
エネルギー分散とその固有状態を求める
- `calc_dos()`: 状態密度を求める
- `calc_kF_index()`: ブリュアンゾーンをメッシュに切ったときのフェルミ波数のインデックスを求める **(工事中)**
- `calc_spin_conductivity(mu, nu)`: スピン伝導度を求める **(工事中)**
- `calc_conductivity(mu, nu)`: 電気伝導度を求める **(工事中)**

と表示をするためのメソッド

- `plot_nsite()`: scf 計算の各ステップにおける各サイトを占有する電子の数
- `plot_scf()`: scf 計算の各ステップにおけるフェルミエネルギーと反強磁性磁化の大きさ
- `plot_band()`: ブリュアンゾーンのパスに沿ったエネルギー分散
- `plot_dos()`: 状態密度
- `plot_fermi_surface()`: フェルミ面の表示 **(工事中)**
- `plot3d_band()`: バンド分散を3次元で表示

が用意されている。

docstring を簡単には書いてあるので詳細は `funcs.py` を解読するとわかるはず
(わかりくかったらごめんなさい)。

`資料/`は元論文や関連資料が入っている。

`output/`は計算に時間がかかるものの出力結果を入れている。
ただ、計算が合っていないものも入っていたりするので気を付けてほしい。

各物理量を計算するのに

``` python
model = fs.KappaET2X(U, Ne, k_mesh)     # インスタンスの作成
model.calc_scf()        # フェルミエネルギーと反強磁性秩序変数の大きさ
model.calc_nscf()       # エネルギー分散とその固有値を求める
```

というようにしてから dos 等を計算するとよい。
